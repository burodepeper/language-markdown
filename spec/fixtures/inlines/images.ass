@521
"![foo](/url "title")" {
  source.text.md {
    link.markup.entity.md {
      "![foo]" {
        image.link.string.md {
          "![": punctuation.md
          "foo"
          "]": punctuation.md
        }
      }
      "(/url "title")" {
        "(": punctuation.md
        destination.link.md {
          "/url": uri.underline.link.md
        }
        " "
        "title" {
          title.link.meta.md {
            """: punctuation.md
            "title"
            """: punctuation.md
          }
        }
        ")": punctuation.md
      }
    }
  }
}

# FIXME
# @522
# "![foo *bar*]"+
# ""+
# "[foo *bar*]: train.jpg "train & tracks"" {
#   source.text.md {
#
#     "![foo *bar*]" {
#       link.markup.entity.md {
#         image.link.string.md {
#           "![": punctuation.md
#           "foo *bar*"
#           "]": punctuation.md
#         }
#       }
#     }
#
#     ""
#
#     "[foo *bar*]: train.jpg "train & tracks"" {
#       reference.link.markup.entity.md {
#         "[foo *bar*]" {
#           text.link.string.md {
#             "[": punctuation.md
#             "foo *bar*"
#             "]": punctuation.md
#           }
#         }
#         ":": punctuation.md
#         " "
#         "train.jpg" {
#           destination.link.md {
#             "train.jpg": uri.underline.link.md
#           }
#         }
#         " "
#         ""train & tracks"" {
#           title.link.meta.md {
#             """: punctuation.md
#             "train & tracks"
#             """: punctuation.md
#           }
#         }
#       }
#     }
#
#   }
# }

# FIXME
# @523
# "![foo ![bar](/url)](/url2)" {
#   source.text.md {
#     link.markup.entity.md {
#       "![foo ![bar](/url)]" {
#         image.link.string.md {
#           "![": punctuation.md
#           "foo ![bar](/url)"
#           "]": punctuation.md
#         }
#       }
#       "(/url2)" {
#         "(": punctuation.md
#         destination.link.md {
#           "/url": uri.underline.link.md
#         }
#         ")": punctuation.md
#       }
#     }
#   }
# }

# FIXME
# @524
# "![foo [bar](/url)](/url2)" {
#   source.text.md {
#     link.markup.entity.md {
#       "![foo [bar](/url)]" {
#         image.link.string.md {
#           "![": punctuation.md
#           "foo [bar](/url)"
#           "]": punctuation.md
#         }
#       }
#       "(/url2)" {
#         "(": punctuation.md
#         destination.link.md {
#           "/url": uri.underline.link.md
#         }
#         ")": punctuation.md
#       }
#     }
#   }
# }

# FIXME no emphasis in link-image
# @525
# "![foo *bar*][]"+
# ""+
# "[foo *bar*]: train.jpg "train & tracks"" {
#   source.text.md {
#     "![foo *bar*][]" {
#       link.markup.entity.md {
#         "![foo *bar*]" {
#           image.link.string.md {
#             "![": punctuation.md
#             "foo *bar*"
#             "]": punctuation.md
#           }
#         }
#         "[]" {
#           label.link.string.md {
#             "[": punctuation.md
#             "]": punctuation.md
#           }
#         }
#       }
#     }
#     ""
#     "[foo *bar*]: train.jpg "train & tracks"" {
#       reference.link.markup.entity.md {
#         "[foo *bar*]" {
#           text.link.string.md {
#             "[": punctuation.md
#             "foo *bar*"
#             "]": punctuation.md
#           }
#         }
#         ":": punctuation.md
#         " "
#         "train.jpg" {
#           destination.link.md {
#             "train.jpg": uri.underline.link.md
#           }
#         }
#         " "
#         ""train & tracks"" {
#           title.link.meta.md {
#             """: punctuation.md
#             "train & tracks"
#             """: punctuation.md
#           }
#         }
#       }
#     }
#   }
# }

# FIXME no emphasis in link-image
# @526
# "![foo *bar*][foobar]"+
# ""+
# "[FOOBAR]: train.jpg "train & tracks"" {
#   source.text.md {
#     "![foo *bar*][foobar]" {
#       link.markup.entity.md {
#         "![foo *bar*]" {
#           image.link.string.md {
#             "![": punctuation.md
#             "foo *bar*"
#             "]": punctuation.md
#           }
#         }
#         "[foobar]" {
#           label.link.string.md {
#             "[": punctuation.md
#             "foobar"
#             "]": punctuation.md
#           }
#         }
#       }
#     }
#     ""
#     "[FOOBAR]: train.jpg "train & tracks"" {
#       reference.link.markup.entity.md {
#         "[FOOBAR]" {
#           text.link.string.md {
#             "[": punctuation.md
#             "FOOBAR"
#             "]": punctuation.md
#           }
#         }
#         ":": punctuation.md
#         " "
#         "train.jpg" {
#           destination.link.md {
#             "train.jpg": uri.underline.link.md
#           }
#         }
#         " "
#         ""train & tracks"" {
#           title.link.meta.md {
#             """: punctuation.md
#             "train & tracks"
#             """: punctuation.md
#           }
#         }
#       }
#     }
#   }
# }

@527
"![foo](train.jpg)" {
  source.text.md {
    link.markup.entity.md {
      "![foo]" {
        image.link.string.md {
          "![": punctuation.md
          "foo"
          "]": punctuation.md
        }
      }
      "(train.jpg)" {
        "(": punctuation.md
        destination.link.md {
          "train.jpg": uri.underline.link.md
        }
        ")": punctuation.md
      }
    }
  }
}

@528
"My ![foo bar](/path/to/train.jpg  "title"   )" {
  source.text.md {
    "My "
    link.markup.entity.md {
      "![foo bar]" {
        image.link.string.md {
          "![": punctuation.md
          "foo bar"
          "]": punctuation.md
        }
      }
      "(/path/to/train.jpg  "title"   )" {
        "(": punctuation.md
        destination.link.md {
          "/path/to/train.jpg": uri.underline.link.md
        }
        "  "
        "title" {
          title.link.meta.md {
            """: punctuation.md
            "title"
            """: punctuation.md
          }
        }
        "   "
        ")": punctuation.md
      }
    }
  }
}

@529
"![foo](<url>)" {
  source.text.md {
    link.markup.entity.md {
      "![foo]" {
        image.link.string.md {
          "![": punctuation.md
          "foo"
          "]": punctuation.md
        }
      }
      "(<url>)" {
        "(": punctuation.md
        destination.link.md {
          "<": punctuation.md
          "url": uri.underline.link.md
          ">": punctuation.md
        }
        ")": punctuation.md
      }
    }
  }
}

@530
"![](/url)" {
  source.text.md {
    link.markup.entity.md {
      "![]" {
        image.link.string.md {
          "![": punctuation.md
          "]": punctuation.md
        }
      }
      "(/url)" {
        "(": punctuation.md
        destination.link.md {
          "/url": uri.underline.link.md
        }
        ")": punctuation.md
      }
    }
  }
}

# NOTE
# Removed @531-533, because not relevant to syntax highlighting
# @burodepeper

# FIXME
# @534
# "![*foo* bar][]"+
# ""+
# "[*foo* bar]: /url "title"" {
#   source.text.md {
#     "![*foo* bar][]" {
#       link.markup.entity.md {
#         "![*foo* bar]" {
#           image.link.string.md {
#             "![": punctuation.md
#             "*foo* bar"
#             "]": punctuation.md
#           }
#         }
#         "[]" {
#           label.link.string.md {
#             "[": punctuation.md
#             "]": punctuation.md
#           }
#         }
#       }
#     }
#     ""
#     "[*foo* bar]: /url "title"" {
#       reference.link.markup.entity.md {
#         "[*foo* bar]" {
#           label.link.string.md {
#             "[": punctuation.md
#             "*foo* bar"
#             "]": punctuation.md
#           }
#         }
#         ":": punctuation.md
#         " "
#         "/url" {
#           destination.link.md {
#             "/url": uri.underline.link.md
#           }
#         }
#         " "
#         ""title"" {
#           title.link.meta.md {
#             '"': punctuation.md
#             "title"
#             '"': punctuation.md
#           }
#         }
#       }
#     }
#   }
# }

# NOTE
# Removed @535-537, because not relevant to syntax highlighting
# @burodepeper

# FIXME
# @538
# "![*foo* bar]"+
# ""+
# "[*foo* bar]: /url "title"" {
#   source.text.md {
#     "![*foo* bar]" {
#       link.markup.entity.md {
#         "![*foo* bar]" {
#           image.link.string.md {
#             "![": punctuation.md
#             "*foo* bar"
#             "]": punctuation.md
#           }
#         }
#       }
#     }
#     " "
#     "[]" {
#       label.link.string.md {
#         "[": punctuation.md
#         "]": punctuation.md
#       }
#     }
#     ""
#     "[*foo* bar]: /url "title"" {
#       reference.link.markup.entity.md {
#         "[*foo* bar]" {
#           label.link.string.md {
#             "[": punctuation.md
#             "*foo* bar"
#             "]": punctuation.md
#           }
#         }
#         ":": punctuation.md
#         " "
#         "/url" {
#           destination.link.md {
#             "/url": uri.underline.link.md
#           }
#         }
#         " "
#         ""title"" {
#           title.link.meta.md {
#             '"': punctuation.md
#             "title"
#             '"': punctuation.md
#           }
#         }
#       }
#     }
#   }
# }

# FIXME
# @539
# "![[foo]]"+
# ""+
# "[[foo]]: /url "title"" {
#   source.text.md {
#     "![[foo]]"
#     ""
#     "[[foo]]: /url "title""
#   }
# }

# NOTE
# Removed @540, because not relevant to syntax highlighting
# @burodepeper

@541
"\!\[foo]" {
  source.text.md {
    "\!": escape.constant.md
    "\[": escape.constant.md
    "foo]"
  }
}

@542
"\![foo]" {
  source.text.md {
    "\!": escape.constant.md
    "[foo]" {
      label.link.string.md {
        "[": punctuation.md
        "foo"
        "]": punctuation.md
      }
    }
  }
}
